<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="Patrick Magee">

  <title>Patrick&#x27;s Blog - SWTOR and Login Automation</title>

  <link rel="canonical" href="/posts/2022-12-22-swtor-login-automation">

      <link type="application/rss+xml" rel="alternate" href="/feed.rss" />
      <link type="application/atom+xml" rel="alternate" href="/feed.atom" />

  <meta name="application-name" content="Patrick&#x27;s Blog" />
  <meta name="msapplication-tooltip" content="Patrick&#x27;s Blog" />
  <meta name="msapplication-starturl" content="/" />
  <meta property="og:title" content="Patrick&#x27;s Blog - SWTOR and Login Automation" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/posts/2022-12-22-swtor-login-automation" />

  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">

  <!-- Bootstrap core CSS -->
  <link href="/vendor/bootstrap/scss/bootstrap.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link href="/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="/vendor/fontawesome-free/css/brands.min.css" rel="stylesheet" type="text/css">
  <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css' data-no-mirror>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css' data-no-mirror>

  <!-- Custom styles for this template -->
  <link href="/scss/clean-blog.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/components/prism-core.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/plugins/autoloader/prism-autoloader.min.js" data-no-mirror></script>
  <script src="https://cdn.jsdelivr.net/npm/quicklink@2.0.0/dist/quicklink.umd.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.19.0/themes/prism.css">

  <!-- Lunr search -->

  


  

</head>

<body>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="/">Patrick&#x27;s Blog</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
            <li class="nav-item">
                <a class="nav-link" href="/about">About me</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/bookmarks">Bookmarks</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/radar">Tech Radar</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/posts">Posts</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/tags">Tags</a>
            </li>
</ul>
    </div>
  </div>
</nav>

  <!-- Page Header -->
  <header class="masthead">
  <div class="overlay"></div>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="post-heading">
          <h1>
            SWTOR and Login Automation
          </h1>
            <h2 class="subheading">How to use 1Password CLI and Power Automate to 1 click login</h2>
              <div class="meta">Published on Thursday, 22 December 2022</div>
                <div class="mt-3">
                      <a href="/tags/1password" class="badge badge-light"> 1Password</a>
                      <a href="/tags/swtor" class="badge badge-light"> SWTOR</a>
                      <a href="/tags/mmorpg" class="badge badge-light"> MMORPG</a>
                </div>
        </div>
      </div>
    </div>
  </div>
</header>

  <!-- Main Content -->
  <div class="container">
    <div class="row">
      <div id="content" class="col-md-12">
        <p>Power Automate should be installed already if you are on Windows 11. I created a brand new flow and named it 'SWTOR Launch'.</p>
<p>You will need to install the 1Password CLI too and ensure it's added to your <code>PATH</code> like any other tool.</p>
<p><img src="https://i.imgur.com/i397HPZ.png" alt="1Password CLI setting" /></p>
<p><img src="https://i.imgur.com/xrPllgz.png" alt="Power Automate" /></p>
<p>There are almost endless possibilies to automate tasks from Power automate ranging from remote to local. Lets take a look at how I have automated the login process for SWTOR.</p>
<p>The next screenshot shows all the individual actions I have inserted as part of my new flow. Each step is using a specific feature which you can click and drag onto the flow which you can then further customise each step to read from custom variables etc.</p>
<p><img src="https://i.imgur.com/J7Kb9QM.png" alt="Flow Steps" /></p>
<p>The first step is to ensure the Launcher is actually running, so that we can insert the credentials into the launcher. The next step is to create a custom script step and use the 1Password CLI tool (added to my PATH) and to use the special one password item API to extract the credentials from my Password manager (This step actually activates Windows Hello, where I can tap my Ubikey to authenticate and allow 1Password to continue).</p>
<p><img src="https://i.imgur.com/KPaEgUJ.png" alt="1Password" /></p>
<p>This command is essentually going to extract the following which is stored in my 1Password like so.....</p>
<p><img src="https://i.imgur.com/8XnU7FT.png" alt="1Password output" /></p>
<p><img src="https://i.imgur.com/3RJeY9k.png" alt="1Password item" /></p>
<p>We want 1Password to output this in a format which we can then consume easily in Power Automate, which is <code>JSON</code> so we use the <code>--format json</code>. This is then inserted into a `%PowershellOutput% variable. Variables can be freely renamed, I just left the default name.</p>
<p>Once we have this, we want to then navigate and extract some of the variables for debugging and ease of use in the following step, which is to convert JSON to a <code>custom object</code>.</p>
<p><img src="https://i.imgur.com/DrC76ud.png" alt="Convert to custom object" /></p>
<p>Once the step runs, you'll notice that the variables are visible as they become populated on the right hand side of the flow window.</p>
<p><img src="https://i.imgur.com/5jgP9uN.png" alt="Variables" /></p>
<p>I then fill in the following additional variables based on the fields that will need to entered within the Launcher. Using the <code>custom object</code> accessors I populate the variables so that they can be used in the UI automation steps.</p>
<p><img src="https://i.imgur.com/Y8wIngk.png" alt="Secrets" /></p>
<p>Next is to ensure that the UI Elements are configured in Power Automate. You can add UI elements by selecting Windows and configuring how it should scan a UI for fields.</p>
<p><img src="https://i.imgur.com/vn8wqww.png" alt="UI Element 1" /></p>
<p><img src="https://i.imgur.com/UcSyi7L.png" alt="UI Element 2" /></p>
<p>You will need to this process for each individual element that needs to have text entered or clicked on.</p>
<p><img src="https://i.imgur.com/sHVogED.png" alt="UI Element 3" /></p>
<p>Once the UI elements are in, we can then add steps to <code>reference</code> these UI elements and populate them.</p>
<p><img src="https://i.imgur.com/Bth1UFc.png" alt="UI Element 4" /></p>
<p>Here's a 30s demo of Power Automate running the flow</p>
<p><img src="/img/swtor/automate.gif" alt="UI Element 5" /></p>

<div class="comments">
    <div id="disqus_thread"></div>
    <script>
        /**
        *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
        *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
        /*
        var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };
        */
        (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://' + 'pjmagee-github-io' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>      </div>
    </div>
  </div>

  <hr>

  <!-- Footer -->
  <footer>
    <div class="container">
        <div class="row">
                <div class="col-md-12 text-center">
                    <p class="copyright text-muted m-0">Copyright &#xA9; 2023</p>
                    <br />
                    <ul class="list-inline text-center small">
                            <li class="list-inline-item">
                                <a href="/feed.rss"><i class="fa fa-rss"></i> RSS Feed</a>
                            </li>
                            <li class="list-inline-item">
                                <a href="/feed.atom"><i class="fa fa-square-rss"></i> Atom Feed</a>
                            </li>
                            <li class="list-inline-item">
                                <a href="http://stackoverflow.com/users/935280/patrick-magee"><i class="fa-brands fa-stack-overflow"></i> Stack Overflow</a>
                            </li>
                            <li class="list-inline-item">
                                <a href="https://www.linkedin.com/in/patrick-magee-76216959"><i class="fa-brands fa-linkedin"></i> LinkedIn</a>
                            </li>
                            <li class="list-inline-item">
                                <a href="https://github.com/pjmagee"><i class="fa-brands fa-github-square"></i> GitHub</a>
                            </li>
                            <li class="list-inline-item">
                                <a href="https://twitter.com/PatrickMageez"><i class="fa-brands fa-twitter-square"></i> Twitter</a>
                            </li>
                    </ul>
                    <br />
                    <div class="font-weight-bold small"><a href="https://statiq.dev">Generated by Statiq</a></div>
                </div>
        </div>
    </div>
</footer>

  <!-- Bootstrap core JavaScript -->
  <script src="/vendor/jquery/jquery.min.js"></script>
  <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  
<script>
       (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-51533669-1', 'auto');
		ga('send', 'pageview', {
		  'page': '<a href="/posts/2022-12-22-swtor-login-automation">SWTOR and Login Automation</a>',
		  'title': 'Patrick&#x27;s Blog - SWTOR and Login Automation'
		});
</script>


  

  <!-- Custom scripts for this template -->
  <script src="/js/clean-blog.js"></script>

</body>

</html>
